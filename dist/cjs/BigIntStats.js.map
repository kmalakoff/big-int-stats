{"version":3,"sources":["/Users/kevin/Dev/_archive/@unmaintained/big-int-stats/src/BigIntStats.ts"],"sourcesContent":["import { Stats } from 'fs';\nimport constants from 'fs-constants';\nimport JSBI from 'jsbi-compat';\n\nvar S_IFIFO = constants.S_IFIFO;\nvar S_IFBLK = constants.S_IFBLK;\nvar S_IFSOCK = constants.S_IFSOCK;\nvar S_IFMT = constants.S_IFMT;\nvar S_IFMT_BIG = JSBI.BigInt(S_IFMT);\n\nvar isWindows = process.platform === 'win32';\nvar kNsPerMsBigInt = JSBI.BigInt(10 ** 6);\n\n// The Date constructor performs Math.floor() to the multiplytamp.\n// https://www.ecma-international.org/ecma-262/#sec-timeclip\n// Since there may be a precision loss when the multiplytamp is\n// converted to a floating point number, we manually round\n// the multiplytamp here before passing it to Date().\n// Refs: https://github.com/nodejs/node/pull/12607\nfunction dateFromMs(ms) {\n  return new Date(JSBI.toNumber(ms) + 0.5);\n}\n\n// @ts-ignore\nexport default class BigIntStats extends Stats {\n  atime: Date;\n  mtime: Date;\n  ctime: Date;\n  birthtime: Date;\n  atimeNs: bigint;\n  mtimeNs: bigint;\n  ctimeNs: bigint;\n  birthtimeNs: bigint;\n\n  constructor(dev: number, mode: number, nlink: number, uid: number, gid: number, rdev: number, blksize: number, ino: number, size: number, blocks: number, atimeNs: bigint, mtimeNs: bigint, ctimeNs: bigint, birthtimeNs: bigint) {\n    super();\n    this.dev = dev;\n    this.mode = mode;\n    this.nlink = nlink;\n    this.uid = uid;\n    this.gid = gid;\n    this.rdev = rdev;\n    this.blksize = blksize;\n    this.ino = ino;\n    this.size = size;\n    this.blocks = blocks;\n    this.atimeMs = JSBI.divide(atimeNs, kNsPerMsBigInt);\n    this.atime = dateFromMs(this.atimeMs);\n    this.atimeNs = atimeNs;\n\n    this.mtimeMs = JSBI.divide(mtimeNs, kNsPerMsBigInt);\n    this.mtime = dateFromMs(this.mtimeMs);\n    this.mtimeNs = mtimeNs;\n\n    this.ctimeMs = JSBI.divide(ctimeNs, kNsPerMsBigInt);\n    this.ctime = dateFromMs(this.ctimeMs);\n    this.ctimeNs = ctimeNs;\n\n    this.birthtimeMs = JSBI.divide(birthtimeNs, kNsPerMsBigInt);\n    this.birthtime = dateFromMs(this.birthtimeMs);\n    this.birthtimeNs = birthtimeNs;\n  }\n\n  _checkModeProperty(property) {\n    if (isWindows && (property === S_IFIFO || property === S_IFBLK || property === S_IFSOCK)) {\n      return false; // Some types are not available on Windows\n    }\n    return JSBI.equal(JSBI.bitwiseAnd(this.mode, S_IFMT_BIG), JSBI.BigInt(property));\n  }\n}\n"],"names":["BigIntStats","S_IFIFO","constants","S_IFBLK","S_IFSOCK","S_IFMT","S_IFMT_BIG","JSBI","BigInt","isWindows","process","platform","kNsPerMsBigInt","dateFromMs","ms","Date","toNumber","dev","mode","nlink","uid","gid","rdev","blksize","ino","size","blocks","atimeNs","mtimeNs","ctimeNs","birthtimeNs","atimeMs","divide","atime","mtimeMs","mtime","ctimeMs","ctime","birthtimeMs","birthtime","_checkModeProperty","property","equal","bitwiseAnd","Stats"],"mappings":";;;;;;;eAwBqBA;;;kBAxBC;kEACA;iEACL;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEjB,IAAIC,UAAUC,oBAAS,CAACD,OAAO;AAC/B,IAAIE,UAAUD,oBAAS,CAACC,OAAO;AAC/B,IAAIC,WAAWF,oBAAS,CAACE,QAAQ;AACjC,IAAIC,SAASH,oBAAS,CAACG,MAAM;AAC7B,IAAIC,aAAaC,mBAAI,CAACC,MAAM,CAACH;AAE7B,IAAII,YAAYC,QAAQC,QAAQ,KAAK;AACrC,IAAIC,iBAAiBL,mBAAI,CAACC,MAAM,CAAC,KAAA,IAAA,IAAM;AAEvC,kEAAkE;AAClE,4DAA4D;AAC5D,+DAA+D;AAC/D,0DAA0D;AAC1D,qDAAqD;AACrD,kDAAkD;AAClD,SAASK,WAAWC,EAAE;IACpB,OAAO,IAAIC,KAAKR,mBAAI,CAACS,QAAQ,CAACF,MAAM;AACtC;AAGe,IAAA,AAAMd,4BAAN;;cAAMA;aAAAA,YAUPiB,GAAW,EAAEC,IAAY,EAAEC,KAAa,EAAEC,GAAW,EAAEC,GAAW,EAAEC,IAAY,EAAEC,OAAe,EAAEC,GAAW,EAAEC,IAAY,EAAEC,MAAc,EAAEC,OAAe,EAAEC,OAAe,EAAEC,OAAe,EAAEC,WAAmB;gCAV7M9B;;gBAWjB,kBAXiBA;QAYjB,MAAKiB,GAAG,GAAGA;QACX,MAAKC,IAAI,GAAGA;QACZ,MAAKC,KAAK,GAAGA;QACb,MAAKC,GAAG,GAAGA;QACX,MAAKC,GAAG,GAAGA;QACX,MAAKC,IAAI,GAAGA;QACZ,MAAKC,OAAO,GAAGA;QACf,MAAKC,GAAG,GAAGA;QACX,MAAKC,IAAI,GAAGA;QACZ,MAAKC,MAAM,GAAGA;QACd,MAAKK,OAAO,GAAGxB,mBAAI,CAACyB,MAAM,CAACL,SAASf;QACpC,MAAKqB,KAAK,GAAGpB,WAAW,MAAKkB,OAAO;QACpC,MAAKJ,OAAO,GAAGA;QAEf,MAAKO,OAAO,GAAG3B,mBAAI,CAACyB,MAAM,CAACJ,SAAShB;QACpC,MAAKuB,KAAK,GAAGtB,WAAW,MAAKqB,OAAO;QACpC,MAAKN,OAAO,GAAGA;QAEf,MAAKQ,OAAO,GAAG7B,mBAAI,CAACyB,MAAM,CAACH,SAASjB;QACpC,MAAKyB,KAAK,GAAGxB,WAAW,MAAKuB,OAAO;QACpC,MAAKP,OAAO,GAAGA;QAEf,MAAKS,WAAW,GAAG/B,mBAAI,CAACyB,MAAM,CAACF,aAAalB;QAC5C,MAAK2B,SAAS,GAAG1B,WAAW,MAAKyB,WAAW;QAC5C,MAAKR,WAAW,GAAGA;;;iBApCF9B;IAuCnBwC,OAAAA,kBAKC,GALDA,SAAAA,mBAAmBC,QAAQ;QACzB,IAAIhC,aAAcgC,CAAAA,aAAaxC,WAAWwC,aAAatC,WAAWsC,aAAarC,QAAO,GAAI;YACxF,OAAO,OAAO,0CAA0C;QAC1D;QACA,OAAOG,mBAAI,CAACmC,KAAK,CAACnC,mBAAI,CAACoC,UAAU,CAAC,IAAI,CAACzB,IAAI,EAAEZ,aAAaC,mBAAI,CAACC,MAAM,CAACiC;IACxE;WA5CmBzC;EAAoB4C,SAAK"}